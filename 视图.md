# 视图

> - ***视图 `View` 是一种虚拟存在的表。视图中的数据并不在数据库中实际存在，行和列数据来自定义视图的查询中使用的表，并且是在使用视图时动态生成的。通俗的讲，视图只保存了查询的SQL逻辑，不保存查询结果。所以我们在创建视图的时候，主要的工作就落在创建这条SQL查询语句上。***

## 视图的操作语法

### 创建视图

> - ***create [or replace] view 视图名称[(列名列表)] as select语句 [with [cascaded | local] check option];***

### 查询视图

> - 查看创建视图语句的语句为 ***show create view 视图名称;***
> - 查看视图数据和查询表一样，把表名替换成视图即可。

### 修改视图

> - ***create [or replace] view 视图名称[(列名列表)] as select语句 [with [cascaded | local] check option];***
> - ***alter view 视图名称[(列名列表)] as select语句 [with [cascaded | local] check option];***

### 删除视图

> - ***drop view [if exists] 视图名称1, ...;***

---

## 视图的检查选项

> - 当使用WITH CHECK OPTION子句创建视图时，MySQL会通过视图检查正在更改的每个行，例如插入，更新，删除（注意，这会修改原来的表结构），以使其符合视图的定义。MySQL允许基于另一个视图创建视图，它还会检查依赖视图中的规则以保持一致性。为了确定检查的范围，MySQL提供了两个选项分别是 `CASCADED` 和 `LOCAL` ，默认值为 `CASCADED` 。

### CASCADED级联

> - 如果视图v1没有创建级联检查选项，基于v1的视图v2创建了，基于v2的视图v3没有创建。
> - 那么往v1插入数据时，它不会检查v1创建时的条件，只会在不满足条件时不显示罢了。
> - 那么往v2插入数据时，它会自动检查插入的东西满不满足v2和v1创建时的筛选条件，不满足直接报错。
> - 那么往v3插入数据时，它会自动检查插入的东西满不满足v2和v1创建时的筛选条件，不满足直接报错，但不会检查v3创建时的条件，只会在不满足条件时不显示罢了。

### LOCAL本地

> - 插入时查看依赖的视图，如果依赖的视图定义了检查选项，那就进行检查，违规就报错，否则不进行检查。

---

## 视图的更新

> - 要使视图可更新，视图中的行与基础表中的行之间必须存在一对一的关系。如果视图包含以下任何一项，则该视图不可更新：
>   - 聚合函数或窗口函数（SUM()、 MIN()、 MAX()、 COUNT()等）
>   - DISTINCT
>   - GROUP BY
>   - HAVING
>   - UNION 或者 UNION ALL

---

## 视图的作用

> - 简单：视图不仅可以简化用户对数据的理解，也可以简化他们的操作。那些被经常使用的查询可以被定义为视图（如多表联查），从而使得用户不必为以后的操作每次指定全部的条件。
> - 安全：数据库可以授权，但不能授权到数据库特定行和特定的列上。通过视图用户只能查询和修改他们所能见到的数据。
> - 数据独立：视图可帮助用户屏蔽真实表结构变化带来的影响。

---
---
